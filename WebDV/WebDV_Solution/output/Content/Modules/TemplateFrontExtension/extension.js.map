{"version":3,"file":"extension.js","sources":["../../../../src/EventHandlers/DVEventHandler.ts","../../../../src/Index.ts"],"sourcesContent":["import { Numerator } from \"@docsvision/webclient/BackOffice/Numerator\";\r\nimport { MessageBox } from \"@docsvision/webclient/Helpers/MessageBox/MessageBox\";\r\nimport { CustomButton } from \"@docsvision/webclient/Platform/CustomButton\";\r\nimport { DateTimePicker } from \"@docsvision/webclient/Platform/DateTimePicker\";\r\nimport { NumberControl } from \"@docsvision/webclient/Platform/Number\";\r\nimport { TextArea } from \"@docsvision/webclient/Platform/TextArea\";\r\nimport { TextBox } from \"@docsvision/webclient/Platform/TextBox\";\r\nimport { CancelableEventArgs } from \"@docsvision/webclient/System/CancelableEventArgs\";\r\nimport { ICardSavingEventArgs } from \"@docsvision/webclient/System/ICardSavingEventArgs\";\r\nimport { IEventArgs } from \"@docsvision/webclient/System/IEventArgs\";\r\nimport { Layout } from \"@docsvision/webclient/System/Layout\";\r\nimport { layoutManager } from \"@docsvision/webclient/System/LayoutManager\";\r\nimport { func } from \"prop-types\";\r\n\r\n\r\nfunction setCountDayBusinesDay(l: Layout, dBTW: Date, dBTT: Date) {\r\n    let CountDayBT = l.controls.tryGet<NumberControl>(\"CountDayBusinessTrip\");\r\n\r\n    if (CountDayBT && dBTW && dBTT) {\r\n        let diff = Math.floor((dBTT.getTime() - dBTW.getTime()) / (1000 * 3600 * 24)) + 1;\r\n        if (diff > 0) CountDayBT.value = diff;\r\n        else CountDayBT.value = null;\r\n    }\r\n}\r\n\r\nexport async function dateBusinessTripWithChanged(sender: DateTimePicker, e: any): JQueryDeferred<void> {\r\n    let _dateBusinessTripTo = sender.layout.controls.tryGet<DateTimePicker>(\"DateBusinessTripTo\");\r\n\r\n    if (_dateBusinessTripTo && _dateBusinessTripTo.value)\r\n        setCountDayBusinesDay(sender.layout, sender.value, _dateBusinessTripTo.value);\r\n}\r\n\r\nexport async function dateBuSinessTripToChanged(sender: DateTimePicker, e: any): JQueryDeferred<void> {\r\n    let _dateBusinessTripWith = sender.layout.controls.tryGet<DateTimePicker>(\"DateBusinessTripWith\");\r\n\r\n    if (_dateBusinessTripWith && _dateBusinessTripWith.value)\r\n        setCountDayBusinesDay(sender.layout, _dateBusinessTripWith.value, sender.value,);\r\n}\r\n\r\nexport async function OnClickButtonShowShortInfo(sender: CustomButton, e: any): JQueryDeferred<void> {\r\n    let _nubmerrequest = sender.layout.controls.tryGet<Numerator>(\"Number\");\r\n    let _dateCreated = sender.layout.controls.tryGet<DateTimePicker>(\"DateCreated\");\r\n    let _dateBTWith = sender.layout.controls.tryGet<DateTimePicker>(\"DateBusinessTripWith\");\r\n    let _dateBTTo = sender.layout.controls.tryGet<DateTimePicker>(\"DateBusinessTripTo\");\r\n    let _baseBTInfo = sender.layout.controls.tryGet<TextArea>(\"BaseForBusinessTrip\");\r\n\r\n    let s = \"\";\r\n\r\n    if (_nubmerrequest && _nubmerrequest.value.number) s +=\"����� ������: \" + _nubmerrequest.value.number + \"\\n\";\r\n    if (_dateCreated && _dateCreated.value) s += \"���� ��������: \" + _dateCreated.value.toLocaleDateString(\"ru\") + \"\\n\";\r\n    if (_dateBTWith && _dateBTWith.value) s += \"���� ������������ �:\" + _dateBTWith.value.toLocaleDateString(\"ru\") + \"\\t\";\r\n    if (_dateBTTo && _dateBTTo.value) s += \"��: \" + _dateBTTo.value.toLocaleDateString(\"ru\") + \"\\n\";\r\n    if (_baseBTInfo && _baseBTInfo.value) s += \"��������� ��� �������: \" + _baseBTInfo.value;\r\n\r\n    if (s != \"\") MessageBox.ShowInfo(s);\r\n    else MessageBox.ShowInfo(\"�� ������� ���� ��� ����������� ����������\");\r\n}\r\n\r\nexport async function CardBeforeSaving(sender: Layout, e: CancelableEventArgs<ICardSavingEventArgs>): JQueryDeferred<void> {\r\n    let _name = sender.controls.tryGet<TextBox>(\"Name\");\r\n\r\n    if (_name && (_name.value == null || _name.value == \"\")) {\r\n        MessageBox.ShowInfo(\"�� ��������� ���� ��������!\");\r\n        e.cancel();\r\n    } \r\n}\r\n","﻿import * as DVEventHandler from \"./EventHandlers/DVEventHandler\";\r\nimport { extensionManager } from \"@docsvision/webclient/System/ExtensionManager\";\r\n\r\n\r\n// Главная входная точка всего расширения\r\n// Данный файл должен импортировать прямо или косвенно все остальные файлы, \r\n// чтобы rollup смог собрать их все в один бандл.\r\n\r\n// Регистрация расширения позволяет корректно установить все\r\n// обработчики событий, сервисы и прочие сущности web-приложения.\r\nextensionManager.registerExtension({\r\n    name: \"DVEventHandler\",\r\n    version: \"1.0.0\",\r\n    globalEventHandlers: [DVEventHandler]\r\n\r\n})"],"names":["MessageBox","extensionManager"],"mappings":"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"}